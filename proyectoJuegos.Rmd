---
title: "Postwork Sesión 8 BEDU Santander Programación en R"
author: 'José David Vázquez Rojas '
output:
  pdf_document:
    latex_engine: xelatex
---
Leemos y damos una primera visualización de los datos
```{r}
library(tidyr)
library(dplyr)
library(ggplot2)
library(lubridate)
library(ggrepel)
library(reshape2)
library(heatmaply)
juegos<-read.csv('juegosVentas.csv')
head(juegos)
```
Exploraremos un  poco el  conjunto que trabajaremos.
```{r}
dim(juegos)
str(juegos)
```


```{r}
summary(juegos)
```
Haremos un poco de limpieza de los datos para llevar una integridad en ellos
```{r}
juegos$Year <- as.Date(as.character(juegos$Year), format="%Y")
juegos$Year <- year(juegos$Year)
juegos$Name <- as.character(juegos$Name)
```
Exploraremos un poco de los comportamientos de características que existen en el dataset
```{r}
ggplot(juegos, aes(x = Year)) + 
  geom_bar(fill = 'blue') + 
  ggtitle("Cantidad de juegos por años") +
  xlab('Año')+
  ylab('Cantidad de juegos')
```
Ahora haremos un recuento de la compañia Top de desarrollador de videojuegos por año desde el 2005.
```{r}
companiaTopAnio <- juegos %>% 
  group_by(Year, Publisher) %>% 
  filter(Year>2005 && Year<2019) %>% 
  summarise(totalIng = sum(Global_Sales)) %>%
  top_n(1)                              
  
ggplot(companiaTopAnio, aes(x = Year, y = totalIng, fill = Publisher)) + 
  geom_bar(stat='identity') + 
  ggtitle("Top desarrollador por año")+
  xlab('Año')+
  ylab('Cantidad de ingresos generados')

```
Ahora, haremos un subset para ver el comportamiento global de ventas por región y genero de los juegos desde 2005 hasta la actualidad.
```{r}
topJuegosAnio <- juegos %>%
  group_by(Year, Name) %>%
  filter(Year>2005 && Year<2019) %>% 
  summarise(Revenue = sum(Global_Sales)) %>%
  top_n(1)

ggplot(topJuegosAnio, aes(x = Year, y = Revenue, fill = Name)) + 
  geom_bar(stat = "identity") + 
  ggtitle("Top Juegos con mayor ingresos por año desde 2005")+
  theme(axis.text.x = element_text(angle = 90))+
  xlab('Año')+
  ylab('Ingresos')
```

```{r}
genre_releases_per_year <- juegos %>%
  group_by(Genre) %>%
  summarise(Total = n(), Percentage = (Total / length(juegos)) * 100) %>%
  arrange(desc(Percentage))

ggplot(genre_releases_per_year, aes(x = Genre, y = Total, fill = Genre)) + 
  geom_bar(stat = "identity") + 
  ggtitle("Cantidad de juegos por género")+
  theme(axis.text.x = element_text(angle = 90))

```


# Regresión multiple 
```{r}
regresion<- juegos %>%
  select(Global_Sales,NA_Sales,PAL_Sales,JP_Sales,Other_Sales) 
regresion<-na.omit(regresion)

heatmaply_cor(
  cor(regresion),
  k_col = 2, 
  k_row = 2
)
```

```{r}
colnames(juegos)
```


